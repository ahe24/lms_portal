<%- include('../partials/head') %>
    <%- include('../partials/sidebar') %>

        <div class="page-header flex-between">
            <div>
                <h1>Í∞ïÏÇ¨ ÎåÄÏãúÎ≥¥Îìú</h1>
                <p>ÎÇ¥ Í∞ïÏùò Î∞è ÏàòÍ∞ïÏÉù ÌòÑÌô©</p>
            </div>
            <a href="/instructor/courses/new" class="btn btn-primary">‚ûï Í∞ïÏùò Í∞úÏÑ§</a>
        </div>

        <% if (courses.length===0) { %>
            <div class="card">
                <div class="empty-state">
                    <div class="empty-icon">üìù</div>
                    <h3>Í∞úÏÑ§Îêú Í∞ïÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§</h3>
                    <p class="text-muted mt-1">ÏÉà Í∞ïÏùòÎ•º Í∞úÏÑ§Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                    <a href="/instructor/courses/new" class="btn btn-primary mt-2">‚ûï Í∞ïÏùò Í∞úÏÑ§</a>
                </div>
            </div>
            <% } else { %>
                <div class="course-grid">
                    <% courses.forEach((c, index)=> { %>
                        <div class="course-card v<%= (index % 6) + 1 %>">
                            <div class="course-card-top">
                                <h3>
                                    <%= c.title %>
                                        <% if (c.instructor_id !==user.id) { %>
                                            <span class="badge badge-info"
                                                style="font-size: 0.65rem; margin-left: 0.5rem; vertical-align: middle;">
                                                Ï£ºÍ∞ïÏÇ¨: <%= c.instructor_name %>
                                            </span>
                                            <% } else { %>
                                                <span class="badge"
                                                    style="background: rgba(255,255,255,0.1); color: var(--text-muted); font-size: 0.65rem; margin-left: 0.5rem; vertical-align: middle;">
                                                    ÎÇ¥ Í∞ïÏùò
                                                </span>
                                                <% } %>
                                </h3>
                                <div class="course-card-icons">
                                    <a href="/instructor/courses/<%= c.id %>/edit" class="icon-btn" title="ÏàòÏ†ï">‚úèÔ∏è</a>
                                    <form method="POST" action="/instructor/courses/<%= c.id %>/delete"
                                        style="display:inline;" onsubmit="return confirm('Í∞ïÏùòÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')">
                                        <button type="submit" class="icon-btn" title="ÏÇ≠Ï†ú">üóëÔ∏è</button>
                                    </form>
                                </div>
                            </div>
                            <p>
                                <%= c.description || 'ÏÑ§Î™Ö ÏóÜÏùå' %>
                            </p>
                            <div class="course-meta">
                                <span>
                                    <span title="Ïó∞Í≤∞Îêú ÏàòÍ∞ïÏÉù"><span class="badge badge-success">
                                            <%= c.approved_count %> ÏàòÍ∞ï
                                        </span></span>
                                    <% if (c.pending_count> 0) { %>
                                        <span class="badge badge-warning">
                                            <%= c.pending_count %> ÎåÄÍ∏∞
                                        </span>
                                        <% } %>
                                </span>
                                <div class="btn-group">
                                    <a href="/instructor/courses/<%= c.id %>/students" class="btn btn-primary btn-sm">üë•
                                        ÏàòÍ∞ïÏÉù Í¥ÄÎ¶¨</a>
                                    <a href="/instructor/courses/<%= c.id %>/edit" class="btn btn-outline btn-sm">‚öôÔ∏è Í∞ïÏùò
                                        ÏÑ§Ï†ï</a>
                                </div>
                            </div>

                            <div class="asset-section">
                                <% if (c.materials.length> 0) { %>
                                    <div class="mb-1">
                                        <span class="asset-label">üìΩÔ∏è Í∞ïÏùò Ïä¨ÎùºÏù¥Îìú</span>
                                        <div class="asset-list">
                                            <% c.materials.forEach(m=> { %>
                                                <a href="/materials/<%= m.id %>/view?courseId=<%= c.id %>"
                                                    target="_blank" class="btn btn-material btn-sm">üìΩÔ∏è <%= m.title %>
                                                </a>
                                                <% }); %>
                                        </div>
                                    </div>
                                    <% } %>

                                        <% if (c.sites.length> 0) { %>
                                            <div>
                                                <span class="asset-label">üåê ÌïôÏäµ ÏÇ¨Ïù¥Ìä∏</span>
                                                <div class="asset-list">
                                                    <% c.sites.forEach(s=> { %>
                                                        <a href="/site/<%= s.slug %>" target="_blank"
                                                            class="btn btn-site btn-sm">üåê <%= s.name %></a>
                                                        <% }); %>
                                                </div>
                                            </div>
                                            <% } %>
                            </div>
                        </div>
                        <% }); %>
                </div>
                <% } %>

                    <!-- Other Instructors' Courses Section -->
                    <div class="page-header" style="margin-top: 4rem;">
                        <h2>ÌÉÄ Í∞ïÏÇ¨ Í∞ïÏùò Î™©Î°ù</h2>
                        <p class="text-muted">Îã§Î•∏ Í∞ïÏÇ¨ÎãòÏù¥ Í∞úÏÑ§Ìïú Í∞ïÏùòÎ•º Ï∞∏Í≥†Ìï† Ïàò ÏûàÏäµÎãàÎã§</p>
                    </div>

                    <% if (otherCourses.length===0) { %>
                        <div class="card">
                            <div class="empty-state" style="padding: 2rem;">
                                <div class="empty-icon" style="font-size: 2rem; margin-bottom: 0.5rem;">üîç</div>
                                <h3 style="font-size: 1rem;">ÌëúÏãúÌï† Îã§Î•∏ Í∞ïÏùòÍ∞Ä ÏóÜÏäµÎãàÎã§</h3>
                            </div>
                        </div>
                        <% } else { %>
                            <div class="course-grid">
                                <% otherCourses.forEach((c, index)=> { %>
                                    <div class="course-card v<%= (index % 6) + 1 %>">
                                        <div class="course-card-top">
                                            <div>
                                                <h3>
                                                    <%= c.title %>
                                                </h3>
                                                <div class="text-xs text-muted mt-1"
                                                    style="display: flex; align-items: center; gap: 0.5rem;">
                                                    <span
                                                        style="background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 4px; font-size: 0.75rem;">
                                                        üë®‚Äçüè´ <%= c.instructor_name %>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <p class="text-sm mt-1 mb-2">
                                            <%= c.description || 'ÏÑ§Î™Ö ÏóÜÏùå' %>
                                        </p>

                                        <div class="course-meta">
                                            <span class="badge badge-secondary"
                                                style="background: var(--bg-secondary); border: 1px solid var(--border-color);">
                                                <%= c.approved_count %>Î™Ö ÏàòÍ∞ïÏÉù
                                            </span>
                                        </div>

                                        <div class="asset-section mt-2">
                                            <% if (c.materials.length> 0) { %>
                                                <div>
                                                    <span class="asset-label">üìΩÔ∏è Í∞ïÏùò Ïä¨ÎùºÏù¥Îìú</span>
                                                    <div class="asset-list">
                                                        <% c.materials.forEach(m=> { %>
                                                            <a href="/materials/<%= m.id %>/view?courseId=<%= c.id %>"
                                                                target="_blank" class="btn btn-outline btn-sm"
                                                                style="border-color: var(--warning); color: var(--warning);">
                                                                <%= m.title %>
                                                            </a>
                                                            <% }); %>
                                                    </div>
                                                </div>
                                                <% } %>
                                                    <% if (c.sites.length> 0) { %>
                                                        <div class="mb-1">
                                                            <span class="asset-label">üåê ÌïôÏäµ ÏÇ¨Ïù¥Ìä∏</span>
                                                            <div class="asset-list">
                                                                <% c.sites.forEach(s=> { %>
                                                                    <a href="/site/<%= s.slug %>" target="_blank"
                                                                        class="btn btn-outline btn-sm"
                                                                        style="border-color: var(--accent); color: var(--accent);">
                                                                        <%= s.name %>
                                                                    </a>
                                                                    <% }); %>
                                                            </div>
                                                        </div>
                                                        <% } %>
                                        </div>
                                    </div>
                                    <% }); %>
                            </div>
                            <% } %>

                                <%- include('../partials/footer') %>