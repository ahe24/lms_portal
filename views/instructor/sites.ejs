<%- include('../partials/head') %>
    <%- include('../partials/sidebar') %>

        <div class="page-header">
            <h1>Í∞ïÏùò ÏÇ¨Ïù¥Ìä∏ Í¥ÄÎ¶¨</h1>
            <p>Ïó∞ÎèôÌï† Í∞ïÏùò ÏÇ¨Ïù¥Ìä∏Î•º Îì±Î°ùÌï©ÎãàÎã§. (ÏßÅÏ†ë Îì±Î°ùÌïú ÏÇ¨Ïù¥Ìä∏Îßå ÏÇ≠Ï†ú Í∞ÄÎä•)</p>
        </div>

        <div class="card mb-2">
            <div class="card-header">
                <span class="card-title">‚ûï ÏÉà Í∞ïÏùò ÏÇ¨Ïù¥Ìä∏ Îì±Î°ù</span>
            </div>
            <form method="POST" action="/instructor/sites">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Ïä¨Îü¨Í∑∏ (ÏòÅÎ¨∏, ÌïòÏù¥Ìîà Í∞ÄÎä•)</label>
                        <input type="text" name="slug" class="form-input" placeholder="Ïòà: fpga-lect" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ÏÇ¨Ïù¥Ìä∏ Ïù¥Î¶Ñ</label>
                        <input type="text" name="name" class="form-input" placeholder="Ïòà: FPGA ÏÑ§Í≥Ñ Ïã§Ïäµ" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">URL</label>
                    <input type="url" name="url" class="form-input" placeholder="Ïòà: http://localhost:5174" required>
                </div>
                <div class="form-group">
                    <label class="form-label">ÏÑ§Î™Ö</label>
                    <textarea name="description" class="form-input" placeholder="Í∞ïÏùò ÏÇ¨Ïù¥Ìä∏ ÏÑ§Î™Ö"></textarea>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" name="is_shared" value="1" checked>
                        <span>Îã§Î•∏ Í∞ïÏÇ¨ÏôÄ Í≥µÏú† (Îã§Î•∏ Í∞ïÏÇ¨Í∞Ä ÏûêÏã†Ïùò Í∞ïÏùòÏóê Ïù¥ ÏÇ¨Ïù¥Ìä∏Î•º Ï∂îÍ∞ÄÌï† Ïàò ÏûàÏäµÎãàÎã§)</span>
                    </label>
                </div>
                <button type="submit" class="btn btn-primary">Îì±Î°ù</button>
            </form>
        </div>

        <div class="card">
            <div class="card-header">
                <span class="card-title">üåê ÎÇ¥ ÏÇ¨Ïù¥Ìä∏ Î™©Î°ù (<%= mySites.length %>)</span>
            </div>
            <% if (mySites.length===0) { %>
                <div class="empty-state">
                    <div class="empty-icon">üåê</div>
                    <h3>Îì±Î°ùÎêú ÏÇ¨Ïù¥Ìä∏Í∞Ä ÏóÜÏäµÎãàÎã§</h3>
                </div>
                <% } else { %>
                    <div class="table-wrap">
                        <table>
                            <thead>
                                <tr>
                                    <th>Ïä¨Îü¨Í∑∏</th>
                                    <th>Ïù¥Î¶Ñ</th>
                                    <th>URL</th>
                                    <th>ÏÑ§Î™Ö</th>
                                    <th>Í≥µÏú†</th>
                                    <th>Í¥ÄÎ¶¨</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% mySites.forEach(s=> { %>
                                    <tr>
                                        <td><code><%= s.slug %></code></td>
                                        <td><strong>
                                                <%= s.name %>
                                            </strong></td>
                                        <td class="text-sm">
                                            <%= s.url %>
                                        </td>
                                        <td class="text-sm text-muted">
                                            <%= s.description || '-' %>
                                        </td>
                                        <td>
                                            <form method="POST" action="/instructor/sites/<%= s.id %>/toggle-share"
                                                style="display:inline;">
                                                <button type="submit"
                                                    class="btn btn-sm <%= s.is_shared ? 'btn-success' : 'btn-outline' %>"
                                                    title="<%= s.is_shared ? 'Í≥µÏú† Ï§ë' : 'ÎπÑÍ≥µÏú†' %>">
                                                    <%= s.is_shared ? '‚úì Í≥µÏú† Ï§ë' : 'ÎπÑÍ≥µÏú†' %>
                                                </button>
                                            </form>
                                        </td>
                                        <td>
                                            <div class="btn-group">
                                                <a href="/instructor/sites/<%= s.id %>/edit"
                                                    class="btn btn-outline btn-sm" title="ÏàòÏ†ï">‚úèÔ∏è</a>
                                                <form method="POST" action="/instructor/sites/<%= s.id %>/delete"
                                                    style="display:inline;" onsubmit="return confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')">
                                                    <button type="submit" class="btn btn-danger btn-sm">üóëÔ∏è</button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                    <% }); %>
                            </tbody>
                        </table>
                    </div>
                    <% } %>
        </div>

        <!-- Shared sites from other instructors -->
        <% if (sharedSites.length> 0) { %>
            <div class="card mt-2">
                <div class="card-header">
                    <span class="card-title">ü§ù Îã§Î•∏ Í∞ïÏÇ¨Í∞Ä Í≥µÏú†Ìïú ÏÇ¨Ïù¥Ìä∏ (<%= sharedSites.length %>)</span>
                </div>
                <div class="table-wrap">
                    <table>
                        <thead>
                            <tr>
                                <th>Ïä¨Îü¨Í∑∏</th>
                                <th>Ïù¥Î¶Ñ</th>
                                <th>URL</th>
                                <th>ÏÑ§Î™Ö</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% sharedSites.forEach(s=> { %>
                                <tr>
                                    <td><code><%= s.slug %></code></td>
                                    <td>
                                        <strong>
                                            <%= s.name %>
                                        </strong>
                                        <span class="badge badge-info" style="margin-left: 0.5rem;">
                                            <%= s.creator_login %>
                                        </span>
                                    </td>
                                    <td class="text-sm">
                                        <%= s.url %>
                                    </td>
                                    <td class="text-sm text-muted">
                                        <%= s.description || '-' %>
                                    </td>
                                </tr>
                                <% }); %>
                        </tbody>
                    </table>
                </div>
            </div>
            <% } %>

                <%- include('../partials/footer') %>