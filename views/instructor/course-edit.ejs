<%- include('../partials/head') %>
    <%- include('../partials/sidebar') %>

        <div class="page-header">
            <h1>Í∞ïÏùò ÏàòÏ†ï</h1>
            <p>Í∞ïÏùò Ï†ïÎ≥¥Î•º ÏàòÏ†ïÌïòÍ≥† Ïó∞Í≤∞Îêú ÏÇ¨Ïù¥Ìä∏ Î∞è PDF ÏûêÎ£åÎ•º Í¥ÄÎ¶¨Ìï©ÎãàÎã§.</p>
        </div>

        <div class="card" style="max-width:600px;">
            <% if (error) { %>
                <div class="alert alert-error">‚ö†Ô∏è <%= error %>
                </div>
                <% } %>

                    <form method="POST" action="/instructor/courses/<%= course.id %>/edit">
                        <div class="form-group">
                            <label class="form-label">Í∞ïÏùòÎ™Ö *</label>
                            <input type="text" name="title" class="form-input" value="<%= course.title %>" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Í∞ïÏùò ÏÑ§Î™Ö</label>
                            <textarea name="description" class="form-input"><%= course.description || '' %></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üîó Í∞ïÏùò ÏÇ¨Ïù¥Ìä∏ ÏÑ†ÌÉù</label>
                            <div class="checkbox-group">
                                <% sites.forEach(s=> { %>
                                    <label class="checkbox-item">
                                        <input type="checkbox" name="site_ids" value="<%= s.id %>"
                                            <%=linkedSiteIds.includes(s.id) ? 'checked' : '' %>>
                                        <span>
                                            <%= s.name %> <small class="text-muted">(<%= s.slug %>)</small>
                                                <% if (s.creator_id !==user.id && s.is_shared) { %>
                                                    <span class="badge badge-info" style="margin-left: 0.5rem;">
                                                        <%= s.creator_login %>
                                                    </span>
                                                    <% } %>
                                        </span>
                                    </label>
                                    <% }); %>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">üìë PDF Í∞ïÏùò ÏûêÎ£å ÏÑ†ÌÉù</label>
                            <div class="checkbox-group">
                                <% materials.forEach(m=> { %>
                                    <label class="checkbox-item">
                                        <input type="checkbox" name="material_ids" value="<%= m.id %>"
                                            <%=linkedMaterialIds.includes(m.id) ? 'checked' : '' %>>
                                        <span>
                                            <%= m.title %>
                                                <% if (m.creator_id !==user.id) { %>
                                                    <span class="badge badge-info" style="margin-left: 0.5rem;">
                                                        <%= m.creator_login %>
                                                    </span>
                                                    <% } %>
                                        </span>
                                    </label>
                                    <% }); %>
                            </div>
                            <div class="form-group">
                                <label class="form-label">üë®‚Äçüè´ Í≥µÎèô Í∞ïÏÇ¨ Ï∂îÍ∞Ä (ÏÑ†ÌÉù)</label>
                                <% if (instructors.length===0) { %>
                                    <p class="text-muted text-sm">Ï∂îÍ∞ÄÌï† Ïàò ÏûàÎäî ÎèôÎ£å Í∞ïÏÇ¨Í∞Ä ÏóÜÏäµÎãàÎã§.</p>
                                    <% } else { %>
                                        <div class="checkbox-group">
                                            <% instructors.forEach(inst=> { %>
                                                <label class="checkbox-item">
                                                    <input type="checkbox" name="instructor_ids" value="<%= inst.id %>"
                                                        <%=(linkedInstructorIds &&
                                                        linkedInstructorIds.includes(inst.id)) ? 'checked' : '' %>>
                                                    <span>
                                                        <%= inst.name %> <small class="text-muted">(<%= inst.login_id %>
                                                                    )</small>
                                                    </span>
                                                </label>
                                                <% }); %>
                                        </div>
                                        <% } %>
                            </div>

                            <div style="margin-top: 2rem; display: flex; gap: 1rem;">
                                <button type="submit" class="btn btn-primary" style="flex: 1;">Ï†ÄÏû•ÌïòÍ∏∞</button>
                                <a href="/instructor" class="btn btn-secondary">Ï∑®ÏÜå</a>
                            </div>
                    </form>
        </div>

        <%- include('../partials/footer') %>