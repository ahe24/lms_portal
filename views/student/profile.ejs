<%- include('../partials/head') %>
    <%- include('../partials/sidebar') %>

        <div class="page-header">
            <h1>내 정보 수정</h1>
            <p>가입 시 입력한 정보를 수정할 수 있습니다</p>
        </div>

        <div class="card" style="max-width:560px;">
            <% if (error) { %>
                <div class="alert alert-error">⚠️ <%= error %>
                </div>
                <% } %>
                    <% if (success) { %>
                        <div class="alert alert-success">✅ <%= success %>
                        </div>
                        <% } %>

                            <form method="POST" action="/student/profile">
                                <div class="form-group">
                                    <label class="form-label">아이디</label>
                                    <input type="text" class="form-input" value="<%= profile.login_id %>" disabled>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">이름 *</label>
                                        <input type="text" name="name" class="form-input" value="<%= profile.name %>"
                                            required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">영문 이름 *</label>
                                        <input type="text" name="name_en" class="form-input"
                                            value="<%= profile.name_en || '' %>" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">이메일 *</label>
                                        <input type="email" name="email" class="form-input"
                                            value="<%= profile.email || '' %>" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">소속 *</label>
                                        <input type="text" name="affiliation" class="form-input"
                                            value="<%= profile.affiliation || '' %>" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label class="form-label">전화번호 *</label>
                                        <input type="tel" name="phone" id="phone" class="form-input"
                                            value="<%= profile.phone || '' %>" maxlength="13" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">생년월일 *</label>
                                        <input type="text" name="birth_date" id="birth_date" class="form-input"
                                            value="<%= profile.birth_date || '' %>" maxlength="8" required>
                                    </div>
                                </div>
                                <div class="flex gap-2">
                                    <button type="submit" class="btn btn-primary">저장</button>
                                    <a href="/student" class="btn btn-outline">취소</a>
                                </div>
                            </form>
        </div>

        <script>
            document.getElementById('phone').addEventListener('input', function () {
                let d = this.value.replace(/\D/g, '');
                if (d.length > 11) d = d.slice(0, 11);
                if (d.length <= 3) this.value = d;
                else if (d.length <= 7) this.value = d.slice(0, 3) + '-' + d.slice(3);
                else this.value = d.slice(0, 3) + '-' + d.slice(3, 7) + '-' + d.slice(7);
            });
            document.getElementById('birth_date').addEventListener('input', function () {
                let d = this.value.replace(/\D/g, '');
                if (d.length > 6) d = d.slice(0, 6);
                if (d.length <= 2) this.value = d;
                else if (d.length <= 4) this.value = d.slice(0, 2) + '/' + d.slice(2);
                else this.value = d.slice(0, 2) + '/' + d.slice(2, 4) + '/' + d.slice(4);
            });
        </script>

        <%- include('../partials/footer') %>